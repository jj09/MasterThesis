%!TEX root = etdrtemplate.tex

\cleardoublepage


\chapter{Introduction}
\label{introduction}

Software is present in all aspects of our life. From the simple program in alarm clock to IPad, through cars, refrigerators and computers. Moreover, our lives are getting more and more depended on Software. Usually when we think about Software, we think about Applications for PC or Smart Phone. E.g. Calculator, Word processor or Stock Market application. In this case, rapid development and smooth operation is a key. However, there is also another, very important class of Software: Safety Critical Systems. It comprises software for Airplanes, Medical Devices, Satellites or Rockets.

Software Engineering for Real-Time and Safety-Critical Systems is very different than creating Business applications. In both types of software we want to ensure correctness and security. However, in each of them, to different extent. In case of mentioned Word processor, software assurance is not critical. When it crashes, it can be restarted. In worst case some part of work is lost. Airplane software crash may put human life in danger or even cause the death. Thus for Safety-Critical systems, the security and correctness is crucial. Behind these reasons, different Software Design methodology and different properties of programming language and its tools are needed.

The most important part of Safety-Critical Systems Design is hazard analysis. How to avoid unintentional states and how to recover from them. Hazard can cause: incident or accident. Former is an event, which not cause loss (but undesired), and could lead to accident. Latter cause the loss (undesired). Hazard analysis can be done manually by human or automatically by software tools. Both AADL and SPARK Ada contains variety of them.

%Overview of Safety-Critical System loop.?
%add more form Nancy's book?

\section{Motivation}
\label{introduction:motivation}
There are many accidents where Medical Devices are involved. Very often, the reason is the lack of communication between different Medical Devices. Drug dosed by PCA Pump may affect patient's level of oxygen and carbon dioxide. Thus adequate monitoring of patient's levels of oxygen and carbon dioxide is required. Moreover, integrated system, which will take adequate action in case of hazard is needed. The solution for such a problem is to create "Integrated Clinical Environment" (ICE). SAnToS Lab at Kansas State University, in cooperation with University of Pennsylvania are working on Medical Device Coordination Framework (MDCF) \cite{MedicalApplicationPlatforms:Paper}, which is prototype implementation of ICE. It is an open source framework for coordinating multiple medical devices to work together.

Devices working under MDCF have to satisfy some requirements. To make Developer's life easier, the requirements will be not only in documentation, but also in code. The code will be generated from models.
Model Driven Development in this case means that there will be some base models (in AADL) for medical devices development. Developer will extend and customize them according to his needs. In the same fashion like File > 'New Java project' in Eclipse, File > 'New Medical device project' will work in GNAT Programming Studio. AADL/BLESS Model will be specification and requirements. In addition to MDCF, which coordinates Medical Devices, we want set of AADL/BLESS models, which can be automatically translated to SPARK Ada. These models will be base for Medical Devices Developers, who can extend and adjust them to implement specific devices. 

[remove below?]
PCA Pump is as an example of Medical Device, which ultimately will work under MDCF.

Why AADL? Because it describes hardware and software. It allows to validate that the software will work on some device.
Why SPARK? Because it contains set of verification tools. 

SPARK is a subset of Ada language, which is easy to deal with it. In the future, when everything will be done (in case of proving perspective) in SPARK, it will (probably) be extended. Maybe finally, there will be no SPARK, but only Ada. Thus for now, SPARK is temporary subset of Ada for reasoning and correctness proving.


\section{Goals}
\label{introduction:goals}
The initial goals, which most of them is accomplished are as follows:
\begin{itemize}
	\item learn about PCA Pump and Infusion pumps properties
	\item SPARK Ada cross-compilation for ARM-device (BeagleBoard-xM)
	\item implement PCA Pump based on Brian Larson's Requirement Document \cite{OpenSourcePCAPump:Paper} (using Ravenscar profile)
	\item develop AADL/BLESS to SPARK Ada mapping
	\item mock PCA Pump AADL/BLESS models in SPARK Ada (based on created mapping and implementation)
	\item implement not generated part (based on implementation) [NOT ACCOMPLISHED - REMOVE?]
	\item create AADL/BLESS to SPARK Ada translator [NOT ACCOMPLISHED - REMOVE?]
	\item Use SPARK tool set for software verification:
		\begin{itemize}
			\item SPARK Examiner
			\item SPARK Simplifier
			\item Proof Obligation Summarizer (POGS)
			\item Sireum Kiasan
			\item GNATprove
		\end{itemize}
\end{itemize}




\section{Contribution}
\label{introduction:contribution}
This thesis demonstrates how AADL/BLESS models can be mapped to SPARK Ada. Additionally it presents current possibilities and limitations of SPARK Ada language, Ravenscar profile and SPARK verification tools. The main contributions of this thesis are as follows:
\begin{itemize}
	\item Review of PCA Pump Requirements document \cite{OpenSourcePCAPump:Paper}
	\item Cross-compilation and testing of SPARK Ada 2005 and 2014 code on BeagleBoard-xM platform
	\item Implementation of PCA Pump based on Requirements document \cite{OpenSourcePCAPump:Paper} and AADL/BLESS models, which validates them
	\item Creation of 
	\item Analysis of different implementation possibilities
	\item AADL/BLESS to SPARK Ada translation schemes
	\item Practical demonstration of SPARK 2005 verification tools: its capabilities and limitations
\end{itemize}


\section{Organization}
\label{introduction:organization}
The thesis is organized in \ref{future_work} [fix this: how to count all chapters?] chapters:
\begin{itemize}
	\item Chapter \ref{introduction} is the problem description and summary of contribution which has been made. 
	\item Chapter \ref{background} is Background that gives details about ICE, MDCF, Model Driven Development, SPARK Ada, AADL/BLESS and available tools for such environment. 
	\item Chapter \ref{pcapump} describe Patient-Controlled Analgesia (PCA) pump.
	\item Chapter \ref{codegen} is about code generation from the model. 
	\item Chapter \ref{pcapumpimpl} describes the implementation of PCA Pump Prototype. Faced issues and design decisions made.
	\item Chapter \ref{verification} describes verification of implemented PCA Pump Prototype. 
	\item Chapter \ref{summary} summarizes all work which has been done in this thesis. 
	\item Chapter \ref{future_work} is the future work that can be done on this topic. In other words: how to continue work started in this thesis.
\end{itemize}


\section{Terms and Acronyms}
\label{introduction:terms}

\begin{itemize}
	\item \textbf{AADL} - Architecture Analysis \& Design Language
	\item \textbf{BLESS} - Behavioral Language for Embedded Systems with Software
	\item \textbf{ICE} - Integrated Clinical Environment
	\item \textbf{MDCF} - Medical Device Coordination Framework
	\item \textbf{PCA} - Patient-Controlled Analgesia (pump)
	\item \textbf{FDA} - Food and Drug Administration
	\item \textbf{GPS} - GNAT Programming Studio
	\item \textbf{GCC} - GNU Compiler Collection
	\item \textbf{GUI} - Graphical user interface
	\item \textbf{VC} - Verification Condition
	\item \textbf{DPC} - Dead Path Conjecture
	\item \textbf{POGS} - Proof Obligation Summarizer
	\item \textbf{VTBI} - Volume to be infused
	\item \textbf{KVO} - Keep Vein Open
\end{itemize}